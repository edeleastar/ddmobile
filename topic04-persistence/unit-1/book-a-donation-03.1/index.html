<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css"
          type="text/css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/railscasts.min.css"
          rel="stylesheet"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
      

body {
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
  font-size:90%;
  color: black;
}

p {
  margin: 0.5em;
}

pre code {
  font-family: "Monaco";
  font-size: 100%;
}

img {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  margin:10px;
}

h1, h2, h3 {
  border-bottom:thin solid black;
  margin-bottom: 0.5em;
  margin-top: 1em;
}

h1 {
  font-style:italic;
  font-size:130%;
}

h2 {
  font-size:110%;
}

h3 {
  font-size:100%;
}



      

html, body {
  height: 100%;
  margin: 0;
}
.wrapper {
  height: 100%;
  display: flex;
  flex-direction: column;
}
.footer {
  background: white;
  text-align: right;
}
.content {
  flex: 1;
  overflow: auto;
}



    </style>
  </head>

  
  

  <div class="ui fixed top pointing inverted stackable menu labmenu">
    <header class="header item">
      <i id="toc" class="sitemap icon"></i>
      
        <a href="../../index.html"> File Formats  </a>
      
    </header>
    <div class="right tab-menu menu">
      
        <a class="item" data-tab="Lab-05">
          Lab-05
        </a>
      
        <a class="item" data-tab="01">
          01
        </a>
      
        <a class="item" data-tab="02">
          02
        </a>
      
        <a class="item" data-tab="03">
          03
        </a>
      
        <a class="item" data-tab="04">
          04
        </a>
      
        <a class="item" data-tab="05">
          05
        </a>
      
        <a class="item" data-tab="06">
          06
        </a>
      
        <a class="item" data-tab="07">
          07
        </a>
      
        <a class="item" data-tab="08">
          08
        </a>
      
        <a class="item" data-tab="09">
          09
        </a>
      
        <a class="item" data-tab="10">
          10
        </a>
      
        <a class="item" data-tab="Exercise">
          Exercise
        </a>
      
        <a class="item" data-tab="Solution">
          Solution
        </a>
      
    </div>
  </div>


  

  <div class="ui pushable">
    <div class="ui inverted labeled icon left inline vertical sidebar menu">
      <br><br>
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic01-overview-and-tools/unit-1/book-a-lab-01/index.html">Lab-01 </a>
          
        
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic01-overview-and-tools/unit-1/book-b-lab-02/index.html">Lab-02 </a>
          
        
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic02-activities-and-navigation/unit-1/book-a-donation-02/index.html">Lab-03 </a>
          
        
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic03-app-structure/unit-1/book-a-donation-03/index.html">Lab-04 </a>
          
        
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic04-persistence/unit-1/book-a-donation-03.1/index.html">Lab-05 </a>
          
        
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic04-persistence/unit-2/book-a-donation-04/index.html">Lab-06 </a>
          
        
      
        
          
            <a class="item"
               href="http://ddrohan.github.io/wit-mad-1-2018//topic04-persistence/unit-2/book-b-donation-realm/index.html">Lab-07 </a>
          
        
      
    </div>
    <div class="pusher" tabindex="-1">
      <div class="ui basic segment">
        <br>
        
          <div class="ui tab segment lab" data-tab="Lab-05">
            <h1>Objectives</h1>
<p>In <b>Donation.3.1</b> you will build on the previous lab and add in some new features and JSON File Support, and an Application Object. On completion of this lab you&#39;ll be able to add File Handling using JSON to an Android Application and work with an &#39;Application&#39; object. </p>

          </div>
        
          <div class="ui tab segment lab" data-tab="01">
            <h1>Setup - Starter Code</h1>
<p>As with the previous labs, you can download the solution/starter code for <a href="archives/Donation.3.1.Starter.zip">Donation.3.1.starter</a>, or continue on with your own version.</p>
<p>Your current project (after renaming/copying) should looks as follows:</p>
<p><img src="img/lab5s101.png" alt=""></p>
<p>In this lab, you are required to do the following:</p>
<ul>
<li>Add a new Menu Option - &#39;Reset&#39; - to clear out any donations after the target is reached</li>
<li>Introduce a serialization mechanism to save and restore the donations list to and from a file </li>
<li>Refactor existing Classes to accommodate the new serialization mechanism</li>
</ul>
<p>The following steps will guide you through these requirements, so we&#39;ll start with the Menu Option.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="02">
            <h1>Adding a new Menu Option</h1>
<p>First of all, confirm that the current Menu looks like this:</p>
<p><img src="img/lab5s201.png" alt=""></p>
<p>but we want something like this:</p>
<p><img src="img/lab5s202.png" alt=""></p>
<p>The first thing to do is add in a new resource in strings.xml (or use Android Studio (Alt + Return) to fix the string resource error if you paste in the menu item directly)</p>
<pre><code class="lang-xml">     &lt;string name=&quot;menuReset&quot;&gt;Reset&lt;/string&gt;</code></pre>
<p>and then the corresponding menu item in donate.xml</p>
<pre><code class="lang-xml">     &lt;item
        android:id=&quot;@+id/menuReset&quot;
        android:orderInCategory=&quot;100&quot;
        app:showAsAction=&quot;never&quot;
        android:title=&quot;@string/menuReset&quot;
        android:onClick=&quot;reset&quot;/&gt;</code></pre>
<p>It&#39;s probably worth removing the &#39;Settings&#39; menu item at this stage too, and its related method in the Base class. Next, edit <b>Base.java</b> and add in the following method stub</p>
<pre><code class="lang-java">public void reset(MenuItem item) {}</code></pre>
<p>to ensure our app won&#39;t crash when the menu loads (and looks for a method &#39;reset&#39;)</p>
<p>Run the app again and confirm you get the following Menu :</p>
<p><img src="img/lab5s202.png" alt=""></p>
<p>We can&#39;t implement this menu option fully yet, so for the moment, we&#39;ll just &#39;reset&#39; the target amount back to zero (0) - Step 03.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="03">
            <h1>Resetting the Target Amount</h1>
<p>This is more of an interim step but is necessary to ensure the menu event handler for the &#39;Reset&#39; option is working correctly.</p>
<p>First, edit <b>Donate.java</b> and introduce an implementation of the &#39;reset&#39; method</p>
<pre><code class="lang-java"> @Override
  public void reset(MenuItem item)
  {
        // Your implementation goes here
  }</code></pre>
<p>the</p>
<pre><code class="lang-java">@Override</code></pre>
<p>annotation is important - can you explain why?</p>
<p>So add in the code necessary to deal with the Reset Menu option being selected, and reset the <i>totalDonated</i> back to zero (0). You also need to update the Donate UI to reflect this reset, so try and have a go at that too.</p>
<p>Run the app again to confirm that the &#39;Reset&#39; Menu option is now functioning.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="04">
            <h1>Application Object</h1>
<p>Before we complete this step, here&#39;s the code you need for the previous step.</p>
<pre><code class="lang-java"> @Override
  public void reset(MenuItem item)
  {
    totalDonated = 0;
    amountTotal.setText(&quot;$&quot; + totalDonated);
    progressBar.setProgress(0);
    donations.clear();
  }</code></pre>
<p>In order to keep out application design coherent, we now bring in an &#39;Application&#39; object.</p>
<p>Create a new package called &#39;ie.app.main&#39; and incorporate this class here:</p>
<pre><code class="lang-java">package ie.app.main;

import android.app.Application;
import android.util.Log;

public class DonationApp extends Application
{
  @Override
  public void onCreate()
  {
    super.onCreate();
    Log.v(&quot;Donate&quot;, &quot;Donation App Started&quot;);
  }
}</code></pre>
<p>Application objects need to be references in the AndroidManifest.xml - at the very top as &#39;andorid:name&#39;</p>
<pre><code class="lang-xml">    &lt;application
        android:allowBackup=&quot;true&quot;
        android:icon=&quot;@mipmap/ic_launcher&quot;
        android:label=&quot;@string/app_name&quot;
        android:supportsRtl=&quot;true&quot;
        android:theme=&quot;@style/AppTheme&quot;
        android:name=&quot;ie.app.main.DonationApp&quot;&gt;</code></pre>
<p>Make sure the &#39;Donation App Started&#39; appears in the logs to verify that it has actually been engaged correctly, when you launch the app.</p>
<p><img src="img/lab5s401.png" alt=""></p>

          </div>
        
          <div class="ui tab segment lab" data-tab="05">
            <h1>Donation Refactoring</h1>
<p>We now need to refactor the Base class (next Step) and move the donation related attributes and method (i.e. the variables target, totalDonated and the donations list, and the newDonation() method) into our DonationApp class.</p>
<p>This is a revised version of DonationApp - which now manages a list of donations. It also centralises the &#39;makeDonation&#39; event implementing it as a method. We will also &#39;open&#39; and  &#39;close&#39; our JSON file here. Replace your DonationApp class with this one:</p>
<pre><code class="lang-java">package ie.app.main;

import java.util.ArrayList;
import java.util.List;

import android.app.Application;
import android.util.Log;
import android.widget.Toast;

import ie.app.models.Donation;

public class DonationApp extends Application
{
    public final int       target       = 10000;
    public int             totalDonated = 0;
    public List &lt;Donation&gt; donations    = new ArrayList&lt;Donation&gt;();

    public boolean newDonation(Donation donation)
    {
        boolean targetAchieved = totalDonated &gt; target;
        if (!targetAchieved) {
            donations.add(donation);
            totalDonated += donation.amount;
        }
        else
            Toast.makeText(this, &quot;Target Exceeded!&quot;, Toast.LENGTH_SHORT).show();

        return targetAchieved;
    }

    @Override
    public void onCreate()
    {
        super.onCreate();
        Log.v(&quot;Donate&quot;, &quot;Donation App Started&quot;);
    }
}</code></pre>
<p>You&#39;ll have a number of errors but wait until the next step to investigate further as a lot of the errors will be fixed at that stage.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="06">
            <h1>Base Class Refactoring</h1>
<p>The Base activity can now be completely refactored to make use of the DonationApp object.</p>
<p>This is our new Base class</p>
<pre><code class="lang-java">package ie.app.activities;

import android.content.Intent;
import android.support.v7.app.AppCompatActivity;
import android.view.Menu;
import android.view.MenuItem;
import android.os.Bundle;

import ie.app.R;
import ie.app.main.DonationApp;

public class Base extends AppCompatActivity {

    public DonationApp app;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        app = (DonationApp) getApplication();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        getMenuInflater().inflate(R.menu.menu_donate, menu);
        return true;
    }

    @Override
    public boolean onPrepareOptionsMenu (Menu menu){
        super.onPrepareOptionsMenu(menu);
        MenuItem report = menu.findItem(R.id.menuReport);
        MenuItem donate = menu.findItem(R.id.menuDonate);
        MenuItem reset = menu.findItem(R.id.menuReset);

        if(app.donations.isEmpty())
        {
            report.setEnabled(false);
            reset.setEnabled(false);
        }
        else {
            report.setEnabled(true);
            reset.setEnabled(true);
        }
        if(this instanceof Donate){
            donate.setVisible(false);
            if(!app.donations.isEmpty())
            {
                report.setVisible(true);
                reset.setEnabled(true);
            }
        }
        else {
            report.setVisible(false);
            donate.setVisible(true);
            reset.setVisible(false);
        }
        return true;
    }

    public void report(MenuItem item)
    {
        startActivity (new Intent(this, Report.class));
    }

    public void donate(MenuItem item)
    {
        startActivity (new Intent(this, Donate.class));
    }

    public void reset(MenuItem item) {}
}</code></pre>
<p>There&#39;ll be a few small errors to fix (relating to references to what was in the Base class, but is now in the Application class) so Builde your project and use Android Studio to help you.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="07">
            <h1>Adding JSON File Support - Part 1</h1>
<p>The Donation model class will need an ability to save and restore itself to some external format. A convenient choice for this format is JSON:</p>
<ul>
<li><a href="http://json.org/">http://json.org/</a></li>
</ul>
<p>Android has support for this format in its libraries:</p>
<pre><code>import org.json.JSONException;
import org.json.JSONObject;</code></pre>
<p>.. we should define in our classes appropriate names for each of the fields we wish to serialize:</p>
<pre><code>  private static final String JSON_ID               = &quot;id&quot;;
  private static final String JSON_AMOUNT           = &quot;amount&quot;;
  private static final String JSON_METHOD           = &quot;method&quot;;</code></pre>
<p>This Donation class will need a new constructor to load a Donation object from JSON:</p>
<pre><code>  public Donation(JSONObject json) throws JSONException
  {
    id       = json.getLong(JSON_ID);
    amount   = json.getInt(JSON_AMOUNT);
    method   = json.getString(JSON_METHOD);
  }</code></pre>
<p>... and a corresponding method to save an object to JSON:</p>
<pre><code>  public JSONObject toJSON() throws JSONException
  {
    JSONObject json = new JSONObject();
    json.put(JSON_ID       , id);
    json.put(JSON_AMOUNT   , amount);
    json.put(JSON_METHOD   , method);
    return json;
  }</code></pre>
<h2>Complete refactored model Donation class for reference purposes:</h2>
<pre><code>public class Donation
{
    public long   id;
    public int    amount;
    public String method;

    private static final String JSON_ID               = &quot;id&quot;;
    private static final String JSON_AMOUNT           = &quot;amount&quot;;
    private static final String JSON_METHOD           = &quot;method&quot;;

    public Donation (int amount, String method)
    {
        this.id = unsignedLong();
        this.amount = amount;
        this.method = method;
    }

    public Donation(JSONObject json) throws JSONException
    {
        id       = json.getLong(JSON_ID);
        amount   = json.getInt(JSON_AMOUNT);
        method   = json.getString(JSON_METHOD);
    }

    public JSONObject toJSON() throws JSONException
    {
        JSONObject json = new JSONObject();
        json.put(JSON_ID       , id);
        json.put(JSON_AMOUNT   , amount);
        json.put(JSON_METHOD   , method);
        return json;
    }

    @Override
    public String toString() {
        return &quot;Donation{&quot; +
                &quot;id= &quot; + id +
                &quot;amount=$&quot; + amount +
                &quot;, method=&#39;&quot; + method + &#39;\&#39;&#39; +
                &#39;}&#39;;
    }

    /**
     * Generate a long greater than zero
     * @return Unsigned Long value greater than zero
     */
    private Long unsignedLong() {
        long rndVal = 0;
        do {
            rndVal = new Random().nextLong();
        } while (rndVal &lt;= 0);
        return rndVal;
    }
}</code></pre>

          </div>
        
          <div class="ui tab segment lab" data-tab="08">
            <h1>Adding JSON File Support - Part 2</h1>
<p>In order to perform the actual serialization, we provide a new model class (DonationSerializer) to save and restore a list of Donations:</p>
<pre><code>package ie.app.models;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.Writer;
import java.util.ArrayList;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONTokener;

import android.content.Context;

public class DonationSerializer
{
    private Context mContext;
    private String mFilename;

    public DonationSerializer(Context c, String f)
    {
        mContext = c;
        mFilename = f;
    }

    public void saveDonations(ArrayList&lt;Donation&gt; donations) throws JSONException, IOException
    {
        // build an array in JSON
        JSONArray array = new JSONArray();
        for (Donation d : donations)
            array.put(d.toJSON());

        // write the file to disk
        Writer writer = null;
        try
        {
            OutputStream out = mContext.openFileOutput(mFilename, Context.MODE_PRIVATE);
            writer = new OutputStreamWriter(out);
            writer.write(array.toString());
        }
        finally
        {
            if (writer != null)
                writer.close();
        }
    }

    public ArrayList&lt;Donation&gt; loadDonations() throws IOException, JSONException
    {
        ArrayList&lt;Donation&gt; donations = new ArrayList&lt;Donation&gt;();
        BufferedReader reader = null;
        try
        {
            // open and read the file into a StringBuilder
            InputStream in = mContext.openFileInput(mFilename);
            reader = new BufferedReader(new InputStreamReader(in));
            StringBuilder jsonString = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null)
            {
                // line breaks are omitted and irrelevant
                jsonString.append(line);
            }
            // parse the JSON using JSONTokener
            JSONArray array = (JSONArray) new JSONTokener(jsonString.toString()).nextValue();
            // build the array of donations from JSONObjects
            for (int i = 0; i &lt; array.length(); i++)
            {
                donations.add(new Donation(array.getJSONObject(i)));
            }
        }
        catch (FileNotFoundException e)
        {
            // we will ignore this one, since it happens when we start fresh
        }
        finally
        {
            if (reader != null)
                reader.close();
        }
        return donations;
    }
}</code></pre>
<p>Place this complete class in the &#39;models&#39; package.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="09">
            <h1>Adding JSON File Support - Part 3</h1>
<p>The DonationApp Application class will now be equipped with the capability to use the serializer to save and restore the Donations it is managing. It will use the DonationSerializer class just developed to do this.</p>
<p>First, introduce the serializer as a member of the DonationApp class:</p>
<pre><code>  private DonationSerializer   serializer;</code></pre>
<p>... then revise the onCreate() to setup a serializer when it is being initialised:</p>
<pre><code>@Override
  public void onCreate()
  {
      super.onCreate();
      Log.v(&quot;Donate&quot;, &quot;Donation App Started&quot;);
      serializer = new DonationSerializer(this,&quot;donations.json&quot;);
          try {
              donations = serializer.loadDonations();
              Log.v(&quot;Donate&quot;, &quot;Donation JSON file Created/Loaded&quot;);
              }
          catch (Exception e) // Catch everything!!
              {
                  Log.v(&quot;Donate&quot;, &quot;Error loading Donations: &quot; + e.getMessage());
                  donations = new ArrayList&lt;Donation&gt;();
              }
  }</code></pre>
<p>Then in your Base class add/Override the following method to save our donations, once the user closes the app.</p>
<pre><code>@Override
    protected void onDestroy() {
        super.onDestroy();

        try {
            app.serializer.saveDonations(app.donations);
            Log.v(&quot;Donate&quot;, &quot;Donation JSON File Saved...&quot;);
        }
        catch (Exception e)
        {
            Log.v(&quot;Donate&quot;, &quot;Error Saving Donations... &quot; + e.getMessage());
        }
    }</code></pre>
<p>Run your app and confirm that you can now persist your donations.</p>
<p>It should now be possible to save and load the donations. Verify that this works - you will need to completely kill the app for this to be verified.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="10">
            <h1>Resetting the Donations</h1>
<p>The last step in this lab involves deleting all the donations in the JSON file when the user wishes to &#39;Reset&#39;.</p>
<p>There&#39;s actually not a lot required in this step - all you need to do is <b>clear()</b> the donations list and store that empty list back to the file when the user selects the Menu option, (we&#39;re not really deleting, but we get what we want!) so modify your reset method (in your Donate.java) as follows:</p>
<pre><code class="lang-java">@Override
  public void reset(MenuItem item)
  {
      app.totalDonated = 0;
      amountTotal.setText(&quot;$&quot; + app.totalDonated);
      progressBar.setProgress(0);
      app.donations.clear();

      try {
          app.serializer.saveDonations(app.donations);
          Log.v(&quot;Donate&quot;, &quot;Donation JSON File Reset...&quot;);
      }
      catch (Exception e)
      {
          Log.v(&quot;Donate&quot;, &quot;Error Resetting Donations... &quot; + e.getMessage());
      }
  }</code></pre>
<p>You also need to update your <i>onPrepareOptionsMenu()</i> method in your <b>Base</b> class to handle the &#39;Reset&#39; menu option being disabled/displayed properly, so refer to the lecture material for this.</p>
<p>That&#39;s about it really - with one exception. There&#39;s a small bug in the app related to when the app restarts and the target <b>HAS NOT</b> been reached.</p>
<p>Can you find it, and more importantly, fix it?</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="Exercise">
            <h1>Exercise - Gson Support</h1>
<p>As an exercise, purely for comparison, have a go at replacing the JSON serializer code with Google&#39;s Gson.</p>
<p>First, you need to add the relevant dependencies, like so:</p>
<pre><code class="lang-xml">compile &#39;com.google.code.gson:gson:2.8.2&#39; // for Googles Gson JSON Parser</code></pre>
<p>Then, referring to the lecture material see if you can refactor the DonationSerializer class to use Gson instead of the standard JSON libraries.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="Solution">
            <h1>Solution</h1>
<p>This is a solution to the lab:</p>
<ul>
<li><a href="archives/Donation.3.1.zip">Donation.3.1</a></li>
</ul>
<p>And here&#39;s the Gson Version</p>
<ul>
<li><a href="archives/Donation.3.1.Gson.zip">Donation.3.1.Gson</a></li>
</ul>

          </div>
        
      </div>
    </div>
  </div>


  <br>
  <script>
    $(document).on('keydown', function(e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

    $(document).ready(function() {
  $('img').addClass('ui image');

  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass(
        'ui basic segment',
      );
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass(
        'ui blue ribbon label',
      );
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.menu .item').tab({
    history: true,
    historyType: 'hash',
  });

  $('.popup').popup();

  $('.ui.sidebar')
    .sidebar({ context: $('.pushable') })
    .sidebar('setting', 'transition', 'slide out')
    .sidebar('attach events', '#toc');
});

  </script>



  <div class="ui bottom fixed borderless right menu">
    <div class="ui right small menu">
      <div class="ui tiny basic message segment">
         Powered by <a href="https://github.com/edeleastar/tutors-ts">tutors-ts.</a> 
      </div>
    </div>
  </div>

  </body>

</html>